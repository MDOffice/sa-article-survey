!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("SAArticleSurvey",[],e):"object"==typeof exports?exports.SAArticleSurvey=e():t.SAArticleSurvey=e()}(self,(function(){return function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,i)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(i,s){var o=t.apply(e,r);function a(t){n(o,i,s,a,u,"next",t)}function u(t){n(o,i,s,a,u,"throw",t)}a(void 0)}))}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.r(e),t.d(e,{default:function(){return o}});var s={containerClass:"card-body",titleClass:"text-secondary",improveClass:"text-secondary",buttonClass:"btn btn-secondary",textareaContainer:"form-group",textareaClass:"form-control",titleUseful:"Была ли эта статья полезна?",titleThx:"Благодарим за отзыв.",titleSor:"Приносим извинения.",titleImprove:"Как можно улучшить эту статью?",titleNeedText:"Укажите текст замечания",btnUseful:"Да",btnNoUseful:"Нет",btnSend:"Отправить"},o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.props=Object.assign({},s,n),this.props.ajax.url||(this.props.ajax.url=e.getAttribute("data-url")),this.props.ajax.articleId||(this.props.ajax.articleId=e.getAttribute("data-id")),this.handleEvents(),this.render()}var e,n,o,a,u;return e=t,n=[{key:"setRating",value:(u=r(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.props.ajax.url,{method:"POST",body:JSON.stringify({id:this.props.ajax.articleId,rating:e})});case 2:5===e?this.actionFinish():this.actionComment();case 3:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"setComment",value:(a=r(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.props.ajax.url,{method:"POST",body:JSON.stringify({id:this.props.ajax.articleId,text:e})});case 2:this.actionFinish();case 3:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"setTitle",value:function(t){this.element.querySelector(".as-title").innerHTML=t}},{key:"actionFinish",value:function(){this.setTitle(this.props.titleThx),this.element.classList.add("submitted")}},{key:"actionComment",value:function(){this.setTitle(this.props.titleSor),this.element.classList.add("rated")}},{key:"handleEvents",value:function(){var t=this;this.element.querySelector(".as-button").addEventListener("click",(function(e){t.setRating(Number(e.target.getAttribute("data-value")))})),this.element.querySelector(".as-submit-button").addEventListener("click",(function(e){var n=t.element.querySelector("textarea").value;""===n.trim()?alert(t.props.titleNeedText):t.setComment(n)}))}},{key:"template",value:function(){return'<div class="as-title '+this.props.titleClass+'">'+this.props.titleUseful+'</div><div class="as-how-improve '+this.props.improveClass+'">'+this.props.titleImprove+'</div><div class="as-button-group"><button class="as-button '+this.props.buttonClass+'" data-value="5" type="button">'+this.props.btnUseful+'</button> <button class="as-button '+this.props.buttonClass+'" data-value="1" type="button">'+this.props.btnNoUseful+'</button></div><form><div class="'+this.props.textareaContainer+'"><textarea aria-label="'+this.props.titleImprove+'" class="'+this.props.textareaClass+'"></textarea></div><button class="as-submit-button '+this.props.buttonClass+'" type="button">'+this.props.btnSend+"</button></form>"}},{key:"render",value:function(){this.element.innerHTML=this.template(),this.element.classList.add(this.props.containerClass)}}],o=[{key:"create",value:function(e,n){return new t(e,n)}}],n&&i(e.prototype,n),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e}()}));